import{d as H,i as b,r as i,o as q,c as I,b as l,w as t,a as g,u as k,a6 as Y,e as T,a7 as j,a8 as G,ac as K,ad as P,F as Q,f as X,Y as Z,T as L,ae as ee,af as N,ag as U,p as le,g as ae,h as te}from"./index-mkXm0lbT.js";import{_ as oe}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-rajnjMkI.js";import{g as ne,a as ue,u as ie,d as de}from"./modelCate-RZdHqOez.js";import{g as S}from"./config-FLsHmEoJ.js";import{_ as re}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./sortable.esm-qwEfw145.js";const D=W=>(le("data-v-4bcc2553"),W=W(),ae(),W),se={class:"table-box"},pe={style:{display:"flex","align-items":"center"}},ce=D(()=>g("div",null,[g("div",{style:{"margin-bottom":"5px","font-size":"15px"}},"模型配置说明"),g("div",{style:{"font-size":"10px"}}," 所有开启的模型将会直接应用到客户端供用户选择使用、请注意如果要设置语音请添加tts模型（他会自己去调用语音相关模型）、会话自动选用DALL-E模型、设为工具类的模型会被系统内部调用、比如翻译、并不会扣除任何人额度！ ")],-1)),me={key:0,style:{display:"flex","align-items":"center"}},fe=D(()=>g("span",null,"编辑模型",-1)),ve={key:1,style:{display:"flex","align-items":"center"}},_e=D(()=>g("span",null,"添加模型",-1)),be={style:{"text-align":"right"}},ge=H({__name:"index",setup(W){const B=b(),o=b({id:null,sort:null,name:null,coin:null,visible:null,bill:null,frequency:null,model:null,max_token:null,upload:null,upload_type:null,net:null,tool:null,history:null}),C=b([]),E=b(!1),M=b(!0),z=function(){C.value.length<=0&&S("models").then(n=>{const{data:a}=n;C.value=JSON.parse(a.value),M.value=!1}),E.value=!0,o.value={id:null,sort:null,name:null,coin:null,visible:null,bill:1,frequency:null,history:null,model:null,max_token:null,upload:null,upload_type:null,net:null,tool:null},_.value=!0},F=b(),J=function(n){C.value.length<=0&&S("models").then(a=>{const{data:s}=a;C.value=JSON.parse(s.value),M.value=!1}),E.value=!1,_.value=!0,o.value=Z({...n}),o.value.tool,F.value=n},_=b(!1),O=async function(n){var e,x;let{id:a,bill:s,coin:p,history:c,frequency:d,max_token:f,model:y,name:r,net:u,sort:v,tool:V,upload:m,visible:w,upload_type:h}=o.value;if(v==null&&(v=0),r==null||r==""){L.error("模型名称不能为空");return}if(y==null||y==""){L.error("绑定模型不能为空");return}if(c==null&&(c=0),d==null&&(d=0),f==null&&(f=0),p==null&&(p=0),h==null&&(h="*"),s=Number(s),p=Number(p),u=Number(u),V=Number(V),m=Number(m),w=Number(w),v=Number(v),d=Number(d),a=Number(a),c=Number(c),f=Number(f),E.value)try{const{data:$}=await ue({bill:s,coin:p,frequency:d,max_token:f,history:c,model:y,name:r,net:u,sort:v,tool:V,upload:m,visible:w,upload_type:h});$.status==0&&(L.success("添加成功"),_.value=!1,(e=B.value)==null||e.getTableList())}catch{}else try{const{data:$}=await ie({id:a,bill:s,coin:p,frequency:d,max_token:f,history:c,model:y,name:r,net:u,sort:v,tool:V,upload:m,visible:w,upload_type:h});$.status==0&&(L.success("添加成功"),_.value=!1,(x=B.value)==null||x.getTableList())}catch{}},R=function(n){ee.confirm("是否确认删除当前模型?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{var a;try{const{data:s}=await de({id:n.id});s.status==0&&(L.success("删除成功"),(a=B.value)==null||a.getTableList())}catch{}})},A=[{prop:"id",label:"ID",align:"center",isShow:!1},{prop:"sort",label:"排序ID",align:"center",tag:!0},{prop:"name",label:"模型名称",align:"center",minWidth:200},{prop:"model",label:"绑定模型",align:"center",tag:!0,minWidth:200},{prop:"visible",label:"对用户可见",align:"center",tag:!0,render:function(n){return N(U,{type:n.row.visible==0?"info":"success"},()=>`${n.row.visible==0?"否":"是"}`)}},{prop:"bill",label:"是否收费",align:"center",tag:!0,render:function(n){return N(U,{type:n.row.bill==0?"info":"success"},()=>`${n.row.bill==0?"否":"是"}`)}},{prop:"coin",label:"积分消耗",align:"center",tag:!0,minWidth:100},{prop:"frequency",label:"使用频率/rpm",align:"center",render:function(n){return N(U,{type:"success"},()=>`${n.row.frequency==0?"不限制":n.row.frequency}`)},minWidth:100},{prop:"max_token",label:"最大token数",align:"center"},{prop:"history",label:"最大历史记录",align:"center"},{prop:"upload",label:"文件上传",align:"center",tag:!0,render:function(n){return N(U,{type:n.row.upload==0?"info":"success"},()=>`${n.row.upload==0?"否":"是"}`)}},{prop:"upload_type",label:"支持文件类型",align:"center",minWidth:200},{prop:"net",label:"联网模式",align:"center",tag:!0,render:function(n){return N(U,{type:n.row.net==0?"info":"success"},()=>`${n.row.net==0?"否":"是"}`)},minWidth:100},{prop:"tool",label:"工具模型",align:"center",tag:!0,render:function(n){return N(U,{type:n.row.tool==0?"info":"success"},()=>`${n.row.tool==0?"否":"是"}`)}},{prop:"operation",label:"操作",width:250,fixed:"right"}];return(n,a)=>{const s=i("Watermelon"),p=i("el-icon"),c=i("el-card"),d=i("el-button"),f=i("Edit"),y=i("Fold"),r=i("el-input"),u=i("el-form-item"),v=i("el-option"),V=i("el-select"),m=i("el-switch"),w=i("el-form"),h=i("el-dialog");return q(),I("div",se,[l(c,null,{default:t(()=>[g("div",pe,[l(p,{size:"35",color:"blue",style:{"margin-right":"10px"}},{default:t(()=>[l(s)]),_:1}),ce])]),_:1}),l(c,{style:{height:"80vh","margin-top":"10px"}},{default:t(()=>[l(oe,{ref_key:"proTable",ref:B,"row-key":"id",height:"60vh",indent:20,"page-sizes":[15,25,50,100],columns:A,"request-api":k(ne),"page-size":15},{tableHeader:t(e=>[l(d,{type:"success",icon:k(Y),onClick:z},{default:t(()=>[T("新增模型")]),_:1},8,["icon"])]),operation:t(e=>[l(d,{type:"primary",icon:k(j),onClick:x=>J(e.row)},{default:t(()=>[T(" 编辑 ")]),_:2},1032,["icon","onClick"]),l(d,{type:"danger",icon:k(G),onClick:x=>R(e.row)},{default:t(()=>[T(" 删除 ")]),_:2},1032,["icon","onClick"])]),_:1},8,["request-api"])]),_:1}),l(h,{modelValue:_.value,"onUpdate:modelValue":a[14]||(a[14]=e=>_.value=e),width:"700"},{header:t(()=>[E.value==!1?(q(),I("div",me,[l(p,null,{default:t(()=>[l(f)]),_:1}),fe])):(q(),I("div",ve,[l(p,null,{default:t(()=>[l(y)]),_:1}),_e]))]),default:t(()=>[l(c,null,{footer:t(()=>[g("div",be,[l(d,{type:"primary",icon:k(K),onClick:O},{default:t(()=>[T("确定")]),_:1},8,["icon"]),l(d,{onClick:a[13]||(a[13]=e=>_.value=!1),icon:k(P),type:"danger"},{default:t(()=>[T("取消")]),_:1},8,["icon"])])]),default:t(()=>[l(w,{"label-width":"auto"},{default:t(()=>[l(u,{prop:"sort",label:"排序ID :"},{default:t(()=>[l(r,{modelValue:o.value.sort,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value.sort=e),type:"number",placeholder:"自定义展示顺序,默认0"},null,8,["modelValue"])]),_:1}),l(u,{prop:"name",label:"模型名 :"},{default:t(()=>[l(r,{modelValue:o.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value.name=e),placeholder:"自定义模型名称"},null,8,["modelValue"])]),_:1}),l(u,{label:"真实模型 :"},{default:t(()=>[l(V,{modelValue:o.value.model,"onUpdate:modelValue":a[2]||(a[2]=e=>o.value.model=e),loading:M.value},{default:t(()=>[(q(!0),I(Q,null,X(C.value,(e,x)=>(q(),te(v,{key:x,label:`[${(e==null?void 0:e.platform)??""}] ${(e==null?void 0:e.model)??""}`,value:e.model},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),l(u,{prop:"name",label:"频率限制/rpm :"},{default:t(()=>[l(r,{modelValue:o.value.frequency,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value.frequency=e),type:"number",placeholder:"每分钟用户可以请求的次数, 留空或者0 为不限制"},null,8,["modelValue"])]),_:1}),l(u,{prop:"name",label:"消耗积分 :"},{default:t(()=>[l(r,{modelValue:o.value.coin,"onUpdate:modelValue":a[4]||(a[4]=e=>o.value.coin=e),type:"number",placeholder:"每次使用消耗的积分"},null,8,["modelValue"])]),_:1}),l(u,{label:"最大历史记录 :"},{default:t(()=>[l(r,{modelValue:o.value.history,"onUpdate:modelValue":a[5]||(a[5]=e=>o.value.history=e),type:"number",placeholder:"模型最大历史记录"},null,8,["modelValue"])]),_:1}),l(u,{label:"最大token :"},{default:t(()=>[l(r,{modelValue:o.value.max_token,"onUpdate:modelValue":a[6]||(a[6]=e=>o.value.max_token=e),type:"number",placeholder:"模型最大支持token数"},null,8,["modelValue"])]),_:1}),l(u,{label:"允许上传的文件类型 :"},{default:t(()=>[l(r,{modelValue:o.value.upload_type,"onUpdate:modelValue":a[7]||(a[7]=e=>o.value.upload_type=e),placeholder:"允许上传的文件类型,默认所有文件"},null,8,["modelValue"])]),_:1}),l(u,{label:"允许文件上传 :"},{default:t(()=>[l(m,{modelValue:o.value.upload,"onUpdate:modelValue":a[8]||(a[8]=e=>o.value.upload=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(u,{label:"允许联网 :"},{default:t(()=>[l(m,{modelValue:o.value.net,"onUpdate:modelValue":a[9]||(a[9]=e=>o.value.net=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(u,{label:"工具模型 :"},{default:t(()=>[l(m,{modelValue:o.value.tool,"onUpdate:modelValue":a[10]||(a[10]=e=>o.value.tool=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(u,{label:"模型对用户可见 :"},{default:t(()=>[l(m,{modelValue:o.value.visible,"onUpdate:modelValue":a[11]||(a[11]=e=>o.value.visible=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(u,{label:"模型免费使用 :"},{default:t(()=>[l(m,{modelValue:o.value.bill,"onUpdate:modelValue":a[12]||(a[12]=e=>o.value.bill=e),"active-value":0,"inactive-value":1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Ne=re(ge,[["__scopeId","data-v-4bcc2553"]]);export{Ne as default};
