import{e as j,B as D}from"./user-aI17CSzd.js";import{E as f,d as w,i as v,r as n,o as S,h as F,w as l,b as t,u as $,j as M,e as c,k as g,t as N,a as x,p as A,g as U,c as P,l as q}from"./index-mkXm0lbT.js";import{_ as E}from"./_plugin-vue_export-helper-x3n3nnut.js";const G=async(o,r,u={},m=!0,p=".xlsx")=>{m&&f({title:"温馨提示",message:"如果数据庞大会导致下载缓慢哦，请您耐心等待！",type:"info",duration:3e3});try{const e=await o(u),a=new Blob([e]);if("msSaveOrOpenBlob"in navigator)return window.navigator.msSaveOrOpenBlob(a,r+p);const _=window.URL.createObjectURL(a),d=document.createElement("a");d.style.display="none",d.download=`${r}${p}`,d.href=_,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(_)}catch{}},H=o=>(A("data-v-dd116d8b"),o=o(),U(),o),J=H(()=>x("div",{class:"el-upload__text"},[c("将文件拖到此处，或"),x("em",null,"点击上传")],-1)),K={class:"el-upload__tip"},Q=w({name:"ImportExcel"}),W=w({...Q,setup(o,{expose:r}){const u=v(!1),m=v(1),p=v(!1),e=v({title:"",fileSize:5,fileType:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),a=i=>{e.value={...e.value,...i},p.value=!0},_=()=>{e.value.tempApi&&G(e.value.tempApi,`${e.value.title}模板`)},d=async i=>{let s=new FormData;s.append("file",i.file),s.append("isCover",u.value),await e.value.importApi(s),e.value.getTableList&&e.value.getTableList(),p.value=!1},B=i=>{const s=e.value.fileType.includes(i.type),b=i.size/1024/1024<e.value.fileSize;return s||f({title:"温馨提示",message:"上传文件只能是 xls / xlsx 格式！",type:"warning"}),b||setTimeout(()=>{f({title:"温馨提示",message:`上传文件大小不能超过 ${e.value.fileSize}MB！`,type:"warning"})},0),s&&b},C=()=>{f({title:"温馨提示",message:"最多只能上传一个文件！",type:"warning"})},I=()=>{f({title:"温馨提示",message:`批量添加${e.value.title}失败，请您重新上传！`,type:"error"})},V=()=>{f({title:"温馨提示",message:`批量添加${e.value.title}成功！`,type:"success"})};return r({acceptParams:a}),(i,s)=>{const b=n("el-button"),h=n("el-form-item"),k=n("upload-filled"),T=n("el-icon"),L=n("el-upload"),z=n("el-switch"),O=n("el-form"),R=n("el-dialog");return S(),F(R,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=y=>p.value=y),title:`批量添加${e.value.title}`,"destroy-on-close":!0,width:"580px",draggable:""},{default:l(()=>[t(O,{class:"drawer-multiColumn-form","label-width":"100px"},{default:l(()=>[t(h,{label:"模板下载 :"},{default:l(()=>[t(b,{type:"primary",icon:$(M),onClick:_},{default:l(()=>[c(" 点击下载 ")]),_:1},8,["icon"])]),_:1}),t(h,{label:"文件上传 :"},{default:l(()=>[t(L,{action:"#",class:"upload",drag:!0,limit:m.value,multiple:!0,"show-file-list":!0,"http-request":d,"before-upload":B,"on-exceed":C,"on-success":V,"on-error":I,accept:e.value.fileType.join(",")},{tip:l(()=>[g(i.$slots,"tip",{},()=>[x("div",K,"请上传 .xls , .xlsx 标准格式文件，文件最大为 "+N(e.value.fileSize)+"M",1)],!0)]),default:l(()=>[g(i.$slots,"empty",{},()=>[t(T,{class:"el-icon--upload"},{default:l(()=>[t(k)]),_:1}),J],!0)]),_:3},8,["limit","accept"])]),_:3}),t(h,{label:"数据覆盖 :"},{default:l(()=>[t(z,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=y=>u.value=y)},null,8,["modelValue"])]),_:1})]),_:3})]),_:3},8,["modelValue","title"])}}}),X=E(W,[["__scopeId","data-v-dd116d8b"]]),Y=o=>(A("data-v-6d10b7c5"),o=o(),U(),o),Z={class:"card content-box"},ee=Y(()=>x("span",{class:"text"},"批量添加数据 🍓🍇🍈🍉",-1)),te=w({name:"batchImport"}),le=w({...te,setup(o){const r=v(),u=()=>{let m={title:"数据",tempApi:j,importApi:D};r.value.acceptParams(m)};return(m,p)=>{const e=n("el-button"),a=n("el-descriptions-item"),_=n("el-descriptions");return S(),P("div",Z,[ee,t(e,{type:"primary",icon:$(q),onClick:u},{default:l(()=>[c(" 批量添加数据 ")]),_:1},8,["icon"]),t(X,{ref_key:"importRef",ref:r},null,512),t(_,{title:"配置项（通过 ref 传递） 📚",column:1,border:""},{default:l(()=>[t(a,{label:"title"},{default:l(()=>[c(" 组件显示标题 && 上传成功之后提示信息 ")]),_:1}),t(a,{label:"fileSize"},{default:l(()=>[c(" 上传文件大小，默认为 5M ")]),_:1}),t(a,{label:"fileType"},{default:l(()=>[c(' 上传文件类型限制，默认类型为 ["application/vnd.ms-excel", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"] ')]),_:1}),t(a,{label:"tempApi"},{default:l(()=>[c(" 下载模板的 Api ")]),_:1}),t(a,{label:"importApi"},{default:l(()=>[c(" 上传数据的 Api ")]),_:1}),t(a,{label:"getTableList"},{default:l(()=>[c(" 上传数据成功之后，刷新表格数据的 Api ")]),_:1})]),_:1})])}}}),ne=E(le,[["__scopeId","data-v-6d10b7c5"]]);export{ne as default};
